<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ³½äº‘æ—¥å¸¸è¿è¥æ¸…å•</title>    

    <link href="https://cdn.staticfile.net/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <script src="https://cdn.staticfile.net/vue/3.3.4/vue.global.prod.min.js"></script>
    <script src="https://cdn.staticfile.net/xlsx/0.18.5/xlsx.full.min.js"></script>

    <style>
        body { background-color: #f3f4f6; font-family: "Microsoft YaHei", 'Segoe UI', sans-serif; }
        .card-hover:hover { transform: translateY(-4px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
        .phase-card { border-left: 4px solid transparent; transition: all 0.3s ease; }
        .phase-card:hover { border-left-width: 8px; }
        .btn-check { transition: all 0.2s; }
        .btn-check:active { transform: scale(0.95); }

        /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #c1c1c1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #a8a8a8; }
        [v-cloak] { display: none; }
    </style>
</head>
<body>

<div id="app" v-cloak class="min-h-screen flex flex-col">

    <nav class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex items-center gap-3">
                    <span class="text-2xl">ğŸ¨</span>
                    <h1 class="font-bold text-xl text-gray-800 tracking-wide">è¿è¥æ•°å­—åŒ–ä¸­æ¢</h1>
                </div>
                <div v-if="currentRole" class="text-sm text-gray-500 font-mono">
                    {{ currentDate }}
                </div>
            </div>
        </div>
    </nav>

    <main class="flex-grow py-8 px-4 sm:px-6 lg:px-8">

        <div v-if="!currentRole" class="max-w-6xl mx-auto">
            <div class="text-center mb-10">
                <h2 class="text-3xl font-extrabold text-gray-900">è¯·é€‰æ‹©ä»Šæ—¥æ‰§å‹¤èº«ä»½</h2>
                <p class="mt-3 text-gray-500">Select Your Role to Start Daily Audit</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 lg:gap-8">
                
                <div @click="selectRole('A')" class="bg-white rounded-2xl p-6 cursor-pointer card-hover shadow-md border border-gray-100 group">
                    <div class="flex items-center justify-between mb-4">
                        <div class="p-3 bg-blue-100 rounded-xl text-blue-600 group-hover:bg-blue-600 group-hover:text-white transition-colors">
                            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/></svg>
                        </div>
                        <span class="text-xs font-bold text-gray-400 bg-gray-50 px-2 py-1 rounded">Dept. A</span>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800">å‰å…éƒ¨</h3>
                    <p class="text-sm text-gray-500 mt-2">Front Office Manager</p>
                </div>

                <div @click="selectRole('E')" class="bg-white rounded-2xl p-6 cursor-pointer card-hover shadow-md border border-gray-100 group">
                    <div class="flex items-center justify-between mb-4">
                        <div class="p-3 bg-teal-100 rounded-xl text-teal-600 group-hover:bg-teal-600 group-hover:text-white transition-colors">
                            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"/></svg>
                        </div>
                        <span class="text-xs font-bold text-gray-400 bg-gray-50 px-2 py-1 rounded">Dept. HK</span>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800">å®¢æˆ¿éƒ¨</h3>
                    <p class="text-sm text-gray-500 mt-2">Housekeeping Manager</p>
                </div>

                <div @click="selectRole('B')" class="bg-white rounded-2xl p-6 cursor-pointer card-hover shadow-md border border-gray-100 group">
                    <div class="flex items-center justify-between mb-4">
                        <div class="p-3 bg-orange-100 rounded-xl text-orange-600 group-hover:bg-orange-600 group-hover:text-white transition-colors">
                            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/></svg>
                        </div>
                        <span class="text-xs font-bold text-gray-400 bg-gray-50 px-2 py-1 rounded">Dept. B</span>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800">é¤é¥®éƒ¨ç»ç†</h3>
                    <p class="text-sm text-gray-500 mt-2">Food & Beverage Manager</p>
                </div>

                <div @click="selectRole('C')" class="bg-white rounded-2xl p-6 cursor-pointer card-hover shadow-md border border-gray-100 group">
                    <div class="flex items-center justify-between mb-4">
                        <div class="p-3 bg-purple-100 rounded-xl text-purple-600 group-hover:bg-purple-600 group-hover:text-white transition-colors">
                            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>
                        </div>
                        <span class="text-xs font-bold text-gray-400 bg-gray-50 px-2 py-1 rounded">Duty Mgr. C</span>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800">å€¼ç­ç»ç†</h3>
                    <p class="text-sm text-gray-500 mt-2">Duty Manager (Check & Balance)</p>
                </div>

                <div @click="selectRole('D')" class="bg-white rounded-2xl p-6 cursor-pointer card-hover shadow-md border border-gray-100 group">
                    <div class="flex items-center justify-between mb-4">
                        <div class="p-3 bg-green-100 rounded-xl text-green-600 group-hover:bg-green-600 group-hover:text-white transition-colors">
                            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/></svg>
                        </div>
                        <span class="text-xs font-bold text-gray-400 bg-gray-50 px-2 py-1 rounded">GM. D</span>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800">æ€»ç»ç†</h3>
                    <p class="text-sm text-gray-500 mt-2">General Manager (Strategy)</p>
                </div>
            </div>
        </div>

        <div v-else class="max-w-5xl mx-auto">

            <div class="bg-white rounded-2xl shadow-sm p-6 mb-6 sticky top-20 z-40 border-l-4" :class="currentConfig.borderColor">
                <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
                    <div>
                        <h2 class="text-2xl font-bold text-gray-800 flex items-center gap-2">
                            {{ currentConfig.title }}
                            <span class="px-2 py-1 bg-gray-100 text-xs text-gray-500 rounded-md font-normal">SOP Checklist</span>
                        </h2>
                        <div class="w-full bg-gray-200 rounded-full h-2.5 mt-3 w-64">
                            <div class="bg-gray-600 h-2.5 rounded-full transition-all duration-500" :style="{ width: completionRate + '%' }" :class="currentConfig.barColor"></div>
                        </div>
                        <p class="text-xs text-gray-400 mt-1">ä»Šæ—¥å®Œæˆåº¦: {{ completionRate }}%</p>
                    </div>

                    <div class="flex gap-3">
                        <button @click="currentRole = null" class="px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg transition">
                            è¿”å›
                        </button>
                        <button @click="exportToExcel" class="px-6 py-2 bg-gray-800 hover:bg-gray-900 text-white rounded-lg shadow transition flex items-center gap-2">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/></svg>
                            å¯¼å‡º Excel
                        </button>
                    </div>
                </div>
            </div>

            <div class="space-y-8 pb-12">
                <div v-for="(phaseTasks, phaseName) in currentTasks" :key="phaseName"
                     class="bg-white rounded-xl shadow-sm overflow-hidden phase-card hover:shadow-md"
                     :class="currentConfig.hoverBorder">

                    <div class="px-6 py-4 bg-gray-50 border-b flex items-center gap-2">
                        <div class="w-2 h-6 rounded-full" :class="currentConfig.accentColor"></div>
                        <h3 class="text-lg font-bold text-gray-700">{{ phaseName }}</h3>
                    </div>

                    <div class="divide-y divide-gray-100">
                        <div v-for="(task, index) in phaseTasks" :key="index" class="p-4 sm:p-6 transition hover:bg-gray-50 flex flex-col sm:flex-row gap-4">

                            <div class="flex-1">
                                <div class="flex items-start gap-3">
                                    <span class="flex-shrink-0 w-6 h-6 rounded-full bg-gray-100 text-gray-500 flex items-center justify-center text-xs font-mono mt-0.5">
                                        {{ index + 1 }}
                                    </span>
                                    <div>
                                        <p class="text-gray-800 font-medium leading-relaxed">{{ task.name }}</p>
                                        <p v-if="task.desc" class="text-sm text-gray-400 mt-1">{{ task.desc }}</p>
                                    </div>
                                </div>
                            </div>

                            <div class="flex flex-col sm:items-end gap-3 min-w-[200px]">
                                <div class="flex rounded-lg shadow-sm w-full sm:w-auto bg-gray-100 p-1">
                                    <button @click="task.status = 'T'"
                                            :class="task.status === 'T' ? 'bg-white text-green-600 shadow-sm font-bold' : 'text-gray-400 hover:text-gray-600'"
                                            class="btn-check flex-1 px-4 py-1.5 rounded-md text-sm transition-all flex items-center justify-center gap-1">
                                        <span v-if="task.status === 'T'">âœ“</span> å®Œæˆ
                                    </button>
                                    <button @click="task.status = 'F'"
                                            :class="task.status === 'F' ? 'bg-white text-red-600 shadow-sm font-bold' : 'text-gray-400 hover:text-gray-600'"
                                            class="btn-check flex-1 px-4 py-1.5 rounded-md text-sm transition-all flex items-center justify-center gap-1">
                                        <span v-if="task.status === 'F'">!</span> æœªå®Œ
                                    </button>
                                </div>
                                <input type="text" v-model="task.remark"
                                       class="w-full text-sm border-b-2 border-transparent bg-gray-50 focus:bg-white focus:border-blue-500 outline-none px-2 py-1 transition-colors rounded"
                                       placeholder="å¤‡æ³¨/å¼‚å¸¸è¯´æ˜ (é€‰å¡«)...">
                            </div>

                        </div>
                    </div>
                </div>

                <div v-if="currentRole === 'C'" class="bg-gray-800 text-gray-300 rounded-xl p-6 mt-8">
                    <h4 class="text-white font-bold mb-4 flex items-center gap-2">
                        âš ï¸ é—®é¢˜ä¸ŠæŠ¥ä¸ååŒè§£å†³æµç¨‹
                    </h4>
                    <div class="grid md:grid-cols-3 gap-4 text-sm">
                        <div class="bg-gray-700 p-3 rounded border border-gray-600">
                            <span class="text-blue-300 font-bold block mb-1">å‰å…/å®¢æˆ¿é—®é¢˜ (A/Eç»„)</span>
                            <span class="text-teal-300 font-bold block mb-1"></span>
                            â†’ ä¸ŠæŠ¥ å‰å…/å®¢æˆ¿ç»„æ€»ç›‘ ååŒè§£å†³
                        </div>
                        <div class="bg-gray-700 p-3 rounded border border-gray-600">
                            <span class="text-orange-300 font-bold block mb-1">é¤é¥®é—®é¢˜ (Bç»„)</span>
                            â†’ ä¸ŠæŠ¥ é¤é¥®ç»„æ€»ç›‘ ååŒè§£å†³
                        </div>
                        <div class="bg-gray-700 p-3 rounded border border-gray-600">
                            <span class="text-red-300 font-bold block mb-1">é‡å¤§å†²çª/å±æœº</span>
                            â†’ ç«‹å³ä¸ŠæŠ¥ <span class="text-white underline">æ‰§è¡Œæ€»ç»ç†</span> æœ€ç»ˆå†³ç­–
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </main>

    <footer class="bg-white border-t py-6 text-center text-gray-400 text-sm">
        <p>&copy; 2026 é…’åº—æ‰§è¡Œæ—¥è¡¨ï¼ˆzlï¼‰. All Data Processed Locally.</p>
    </footer>

</div>

<script>
    const { createApp, ref, computed } = Vue;

    // --- 1. æœˆåº¦ä»»åŠ¡æ•°æ®åº“ (æ–°å¢éƒ¨åˆ†) ---
    const MONTHLY_MISSIONS = [
        // 1æœˆ
        [{name: "æ˜¥èŠ‚æ°›å›´å¸ƒç½®éªŒæ”¶", desc: "æ£€æŸ¥å¤§å ‚/é¤å…å¹´å‘³è£…é¥°åŠèƒŒæ™¯éŸ³ä¹"}, {name: "å¹´å¤œé¥­é¢„è®¢æ¢³ç†", desc: "å®¡æ ¸å¹´å¤œé¥­èœå•ä¸é¢„è®¢å®šé‡‘æ”¶å–"}, {name: "æ˜¥èŠ‚æ’ç­ç¡®è®¤", desc: "ç¡®è®¤ä¸‰å€è–ªèµ„ä¸ç•™å®ˆå‘˜å·¥å…³æ€€"}],
        // 2æœˆ
        [{name: "å¼€å·¥åŠ¨å‘˜ä¼š", desc: "èŠ‚åæ”¶å¿ƒä¸å¼€å·¥çº¢åŒ…å‘æ”¾"}, {name: "å…ƒå®µèŠ‚æ´»åŠ¨æ‰§è¡Œ", desc: "æ±¤åœ†èµ é€ä¸ç¯è°œæ´»åŠ¨ç£å¯¼"}, {name: "è®¾å¤‡å¤å·¥æ£€æŸ¥", desc: "é•¿æœŸåœç”¨è®¾å¤‡çš„è¯•è¿è¡Œæ£€æŸ¥"}],
        // 3æœˆ
        [{name: "æ˜¥å­£è¸é’è¥é”€", desc: "å‘¨è¾¹æ¸¸è·¯çº¿æ¨å¹¿ä¸é‡é¤åŒ…ä¸Šçº¿"}, {name: "å·¥ç¨‹ä¿å…»æœˆå¯åŠ¨", desc: "ç©ºè°ƒæ»¤ç½‘æ¸…æ´—ä¸å¢™é¢ä¿®è¡¥è®¡åˆ’å®¡æ‰¹"}, {name: "Q1 ç»è¥å¤ç›˜", desc: "ç¬¬ä¸€å­£åº¦ç»è¥æ•°æ®åˆ†æä¼š"}],
        // 4æœˆ
        [{name: "å¹¿äº¤ä¼š/äº”ä¸€å¤‡æˆ˜", desc: "åˆ¶å®šèŠ‚æ—¥æˆ¿ä»·ç­–ç•¥ä¸è¶…é¢„è®¢æ–¹æ¡ˆ"}, {name: "é˜²æ±›é˜²å°æ¼”ç»ƒ", desc: "æ£€æŸ¥æ²™è¢‹/æ°´æ³µåŠåº”æ€¥é¢„æ¡ˆåŸ¹è®­"}, {name: "OTA è¯„ä»·ç»´æŠ¤", desc: "å¤„ç†è¿‘æœŸå·®è¯„ï¼Œæå‡äº”ä¸€å‰è¯„åˆ†"}],
        // 5æœˆ
        [{name: "äº”ä¸€æ¥å¾…å¤ç›˜", desc: "åˆ†æèŠ‚æ—¥æœŸé—´æœåŠ¡çŸ­æ¿ä¸è¥æ”¶äº®ç‚¹"}, {name: "å©šå®´æ—ºå­£æ‰§è¡Œ", desc: "æ£€æŸ¥å®´ä¼šå…è®¾å¤‡ä¸å©šåº†è¿›åœºåè°ƒ"}, {name: "æ¯äº²èŠ‚æ´»åŠ¨ç£å¯¼", desc: "ç‰¹æƒ æˆ¿å‹ä¸åº·ä¹ƒé¦¨èµ é€è½å®"}],
        // 6æœˆ
        [{name: "å¹´ä¸­å†²åˆºåŠ¨å‘˜", desc: "ä¸ŠåŠå¹´KPIå·®è·åˆ†æä¸èµ¶è¶…è®¡åˆ’"}, {name: "æˆæœ¬æ§åˆ¶ä¸“é¡¹", desc: "åˆ†æä¸ŠåŠå¹´èƒ½è€—ä¸äººåŠ›æˆæœ¬ï¼Œåˆ¶å®šæ§æœ¬æ–¹æ¡ˆ"}, {name: "ç«¯åˆç²½å­é”€å”®ç›‘æ§", desc: "ä¸´æœŸåº“å­˜ä¿ƒé”€å†³ç­–"}],
        // 7æœˆ
        [{name: "æš‘æœŸäº²å­æ´»åŠ¨æ£€æŸ¥", desc: "å„¿ç«¥ä¹å›­å®‰å…¨æ£€æŸ¥ä¸äº²å­æˆ¿å¸ƒç½®"}, {name: "è®¡åˆ’å«ç”Ÿå¤æ ¸", desc: "çª—å¸˜/åœ°æ¯¯/åº§å«æ·±å±‚æ¸…æ´—è¿›åº¦æ£€æŸ¥"}, {name: "é˜²æš‘é™æ¸©å·¥ä½œ", desc: "å‘˜å·¥é«˜æ¸©è¡¥è´´ä¸å‡‰èŒ¶ä¾›åº”æ£€æŸ¥"}],
        // 8æœˆ
        [{name: "ä¸ƒå¤•è¥é”€æ–¹æ¡ˆç»ˆå®¡", desc: "æƒ…ä¾£å¥—é¤ä»·æ ¼ä¸æ°›å›´å¸ƒç½®å®¡æ‰¹"}, {name: "æœˆé¥¼é¢„å”®å¯åŠ¨", desc: "ä¾›åº”å•†åˆåŒå®¡æ‰¹ä¸å…¨å‘˜è¥é”€åŠ¨å‘˜"}, {name: "åŠå¹´è®¾å¤‡ç»´ä¿", desc: "ç”µæ¢¯/é”…ç‚‰/æ¶ˆé˜²ä¸»æœºå¹´æ£€"}],
        // 9æœˆ
        [{name: "åº—åº†æœˆæ´»åŠ¨åé•‡", desc: "å¤§é¢å……å€¼ç‰¹æ‰¹ä¸ä¼šå‘˜ç­”è°¢"}, {name: "ä¸­ç§‹æ¥å¾…é«˜å³°ç£å¯¼", desc: "æœˆé¥¼æè´§æµç•…åº¦ä¸å›¢åœ†å®´æœåŠ¡"}, {name: "å‘˜å·¥èŒ¶è¯ä¼š", desc: "Q3 å‘˜å·¥æ€æƒ³åŠ¨æ€å…³æ³¨"}],
        // 10æœˆ
        [{name: "å›½åº†é»„é‡‘å‘¨æ¥å¾…", desc: "æ¯æ—¥æˆ¿ä»·åŠ¨æ€è°ƒæ•´ä¸æŠ•è¯‰æçº§å¤„ç†"}, {name: "æ˜å¹´é¢„ç®—å¯åŠ¨ä¼š", desc: "ä¸‹å‘å„éƒ¨é—¨é¢„ç®—ç¼–åˆ¶æ¨¡æ¿ä¸ç›®æ ‡"}, {name: "é‡é˜³èŠ‚æ•¬è€æ´»åŠ¨", desc: "ç¤¾åŒºå…¬ç›Šæˆ–ä½åº—è€äººå…³æ€€"}],
        // 11æœˆ
        [{name: "å¹´åº¦é¢„ç®—ç­”è¾©", desc: "å¬å–å„éƒ¨é—¨æ˜å¹´é¢„ç®—æ±‡æŠ¥å¹¶è´¨è¯¢"}, {name: "119 æ¶ˆé˜²å®£ä¼ æœˆ", desc: "å…¨å‘˜æ¶ˆé˜²å®æ“æ¼”ç»ƒä¸ç–æ•£æ¼”ä¹ "}, {name: "ä¾›æš–ç³»ç»Ÿè°ƒè¯•", desc: "ç¡®ä¿å†¬è‡³å‰ä¾›æš–è®¾å¤‡æ­£å¸¸"}],
        // 12æœˆ
        [{name: "å¹´ç»ˆå†³ç®—ä¸ç»©æ•ˆ", desc: "å…¨å‘˜å¹´åº¦ç»©æ•ˆè€ƒè¯„ä¸å¥–é‡‘æµ‹ç®—"}, {name: "åŒæ—¦æ´»åŠ¨ç£å¯¼", desc: "åœ£è¯/å…ƒæ—¦æ´»åŠ¨ç°åœºæ£€æŸ¥"}, {name: "å¹´åº¦å¤§å®¢æˆ·ç­”è°¢", desc: "å¯„é€å¹´åº¦ç¤¼å“æˆ–ä¸Šé—¨æ‹œè®¿"}, {name: "è·¨å¹´å¤œå®‰å…¨å€¼å®ˆ", desc: "ä¸»è¦ç®¡ç†äººå‘˜ç°åœºå€¼ç­"}]
    ];
    const MONTH_NAMES = ["ä¸€æœˆ", "äºŒæœˆ", "ä¸‰æœˆ", "å››æœˆ", "äº”æœˆ", "å…­æœˆ", "ä¸ƒæœˆ", "å…«æœˆ", "ä¹æœˆ", "åæœˆ", "åä¸€æœˆ", "åäºŒæœˆ"];

    // --- æ ¸å¿ƒæ•°æ®é…ç½® ---
    const ROLE_CONFIGS = {
        'A': {
            title: 'A - å‰å…éƒ¨',
            borderColor: 'border-blue-500',
            barColor: 'bg-blue-600',
            hoverBorder: 'hover:border-blue-400',
            accentColor: 'bg-blue-500'
        },
        'E': {  // æ–°å¢å®¢æˆ¿éƒ¨é…ç½®
            title: 'E - å®¢æˆ¿éƒ¨',
            borderColor: 'border-teal-500',
            barColor: 'bg-teal-600',
            hoverBorder: 'hover:border-teal-400',
            accentColor: 'bg-teal-500'
        },
        'B': {
            title: 'B - é¤é¥®éƒ¨',
            borderColor: 'border-orange-500',
            barColor: 'bg-orange-600',
            hoverBorder: 'hover:border-orange-400',
            accentColor: 'bg-orange-500'
        },
        'C': {
            title: 'C - å€¼ç­ç»ç†',
            borderColor: 'border-purple-500',
            barColor: 'bg-purple-600',
            hoverBorder: 'hover:border-purple-400',
            accentColor: 'bg-purple-500'
        },
        'D': {
            title: 'D - æ€»ç»ç†',
            borderColor: 'border-green-500',
            barColor: 'bg-green-600',
            hoverBorder: 'hover:border-green-400',
            accentColor: 'bg-green-500'
        }
    };

    // æ›´æ–°åçš„æ•°æ®å†…å®¹
    const TASK_DATA_TEMPLATE = {
        'A': { // å‰å…éƒ¨
            'ä¸€ã€å‡†å¤‡é˜¶æ®µ (æ—©ç­/å¼€ç­)': [
                { name: 'æ˜¨æ—¥å¤ç›˜ï¼šæ˜¨æ—¥æ—©é¤å®é™…ç”¨é¤äººæ•°å·²ç»Ÿè®¡', status: '', remark: '' },
                { name: 'æ˜¨æ—¥å¤ç›˜ï¼šæ˜¨æ—¥ç½‘ç»œå·®è¯„/æŠ•è¯‰å·²å…¨éƒ¨å¤„ç†å¹¶é—­ç¯', status: '', remark: '' },
                { name: 'ä»Šæ—¥è¿è¥ï¼šä»Šæ—¥é¢„ç¦»å®¢äººåå•å·²æ ¸æŸ¥ï¼Œç‰¹æ®Šè¦æ±‚å·²æ ‡è®°', status: '', remark: '' },
                { name: 'ä»Šæ—¥è¿è¥ï¼šå·²åè°ƒå®¢æˆ¿éƒ¨å¯¹é¢„ç¦»æˆ¿è¿›è¡Œé¢„æŸ¥æˆ¿å‡†å¤‡', status: '', remark: '' },
                { name: 'ä»Šæ—¥è¿è¥ï¼šé€å›¢', status: '', remark: '' },
                { name: 'ä»Šæ—¥è¿è¥ï¼šä»Šæ—¥é¢„æŠµå®¢äººé¢„è®¢å·²å…¨é¢æ ¸æŸ¥å¹¶é¢„æ’æˆ¿', status: '', remark: '' },
                { name: 'ä»Šæ—¥è¿è¥ï¼šæ‰€æœ‰é¢„æŠµå®¢äººæˆ¿å¡/é’¥åŒ™å·²å‡†å¤‡', status: '', remark: '' },
                { name: 'ä»Šæ—¥è¿è¥ï¼šä»Šæ—¥åœ¨åº—åŠé¢„æŠµVIPåå•ï¼ˆå«çº¿ä¸‹ï¼‰å·²ç”Ÿæˆ', status: '', remark: '' },
                { name: 'ä»Šæ—¥è¿è¥ï¼šå¯¹VIPçš„ä¸ªæ€§åŒ–æœåŠ¡ï¼ˆæ¬¢è¿ç¤¼é‡ã€å®¢æˆ¿å¸ƒç½®ç­‰ï¼‰å·²éƒ¨ç½²', status: '', remark: '' },
                { name: 'æ˜æ—¥é¢„å¤‡ï¼šæ˜æ—¥é¢„æŠµå®¢äººé¢„è®¢å·²åˆæ­¥å¤æ ¸', status: '', remark: '' },
                { name: 'æ˜æ—¥é¢„å¤‡ï¼šå·²å¯¹æ˜æ—¥é¢„æŠµå®¢äººè¿›è¡Œåˆæ­¥å®¢æˆ¿é¢„æ’', status: '', remark: '' },
                { name: 'å£°èª‰ç›®æ ‡ï¼šå·²è¯†åˆ«è‡³å°‘5ä½çº¿ä¸Šæ¸ é“ç›®æ ‡å¥½è¯„å®¢äºº', status: '', remark: '' },
                { name: 'å£°èª‰ç›®æ ‡ï¼šå·²è¯†åˆ«è‡³å°‘5ä½çº¿ä¸‹æ¸ é“ç›®æ ‡å¥½è¯„å®¢äºº', status: '', remark: '' },
                { name: 'å†…éƒ¨å‡†å¤‡ï¼šç­å‰ä¼šå·²å¬å¼€ï¼Œå‘˜å·¥ä»ªå®¹ä»ªè¡¨åˆæ ¼', status: '', remark: '' },
                { name: 'å†…éƒ¨å‡†å¤‡ï¼šå‰å°æ‰€æœ‰è¿è¥è®¾å¤‡ã€è¡¨å•ã€ç‰©èµ„å·²å¤‡é½', status: '', remark: '' },
                { name: 'å†…éƒ¨å‡†å¤‡ï¼šå·²ä¸å®¢æˆ¿éƒ¨æ ¸å¯¹ç¡®è®¤å½“å‰å¯å”®æˆ¿æ€', status: '', remark: '' },
                { name: 'å†…éƒ¨ååŒï¼šå·²å°†ä»Šæ—¥å®´ä¼š/å›¢é˜Ÿç”¨é¤ä¿¡æ¯åŒæ­¥é¤é¥®éƒ¨', status: '', remark: '' },
                { name: 'å†…éƒ¨ååŒï¼šå·²å°†ä»Šæ—¥VIPåŠé‡ç‚¹å®¢äººåå•åŒæ­¥å€¼ç­ç»ç†', status: '', remark: '' }
            ],
            'äºŒã€æ‰§è¡Œé˜¶æ®µ (è¿è¥ä¸­)': [
                { name: 'æœåŠ¡æ ‡å‡†ï¼šå„å²—ä½å‘˜å·¥ä¸¥æ ¼æŒ‰SOPæ‰§è¡ŒæœåŠ¡', status: '', remark: '' },
                { name: 'æœåŠ¡æ ‡å‡†ï¼šä¸»åŠ¨æ‰§è¡Œä¼šå‘˜æ¨ä»‹ä¸ç™»è®°ï¼Œå°è´¦å‡†ç¡®', status: '', remark: '' },
                { name: 'æœåŠ¡æ ‡å‡†ï¼šVIPåŠç›®æ ‡å¥½è¯„å®¢äººè¢«å…¨ç¨‹é‡ç‚¹è·Ÿè¿›', status: '', remark: '' },
                { name: 'è´¨é‡æ£€æŸ¥ï¼šå·¡æŸ¥æœ¬éƒ¨é—¨å²—ä½çºªå¾‹ï¼ˆç©ºå²—ã€ç©æ‰‹æœºï¼‰', status: '', remark: '' },
                { name: 'è´¨é‡æ£€æŸ¥ï¼šå…¬å…±åŒºåŸŸï¼ˆå¤§å ‚ã€ç”µæ¢¯ã€æ´—æ‰‹é—´ï¼‰å«ç”Ÿä¸çŠ¶å†µè‰¯å¥½', status: '', remark: '' },
                { name: 'ç½‘ç»œå£°èª‰ï¼šå·²å¼•å¯¼å¹¶ç¡®ä¿æ–°å¢ä¸å°‘äº5æ¡5åˆ†å¥½è¯„', status: '', remark: '' },
                { name: 'ç½‘ç»œå£°èª‰ï¼šæ¶‰åŠæœ¬éƒ¨é—¨çš„åœ¨çº¿è¯„ä»·å·²100%å›å¤', status: '', remark: '' },
                { name: 'ç½‘ç»œå£°èª‰ï¼šå·®è¯„ï¼ˆ<4.8åˆ†ï¼‰å·²ç«‹å³ä¸ŠæŠ¥å€¼ç­ç»ç†', status: '', remark: '' },
                { name: 'è¿è¥æ§åˆ¶ï¼šä¸å®¢æˆ¿éƒ¨ä¿æŒå®æ—¶æˆ¿æ€ä¿¡æ¯åŒæ­¥', status: '', remark: '' },
                { name: 'è¿è¥æ§åˆ¶ï¼šæœ¬éƒ¨é—¨ç›¸å…³æŠ•è¯‰å·²ç°åœºå¤„ç†ï¼Œè§£å†³ç‡è¾¾æ ‡ï¼ˆâ‰¥95%ï¼‰', status: '', remark: '' },
                { name: 'è¿è¥æ§åˆ¶ï¼šå®æ—¶è®°å½•ä¼šå‘˜å……å€¼ã€å‡çº§é”€å”®ç­‰è¿è¥æ•°æ®', status: '', remark: '' }
            ],
            'ä¸‰ã€æ”¶å°¾ä¸äº¤æ¥é˜¶æ®µ (æ™šç­/äº¤ç­å‰)': [
                { name: 'æ—¥ç»“å·¥ä½œï¼šæ‰€æœ‰è´¦ç›®å·²æ ¸å¯¹ã€å°è´¦ï¼Œè´¦å®ç›¸ç¬¦', status: '', remark: '' },
                { name: 'æ—¥ç»“å·¥ä½œï¼šæœ¬æ—¥è¿è¥æ•°æ®ï¼ˆè¥æ”¶ã€ä¼šå‘˜é”€å”®ç­‰ï¼‰å·²æ±‡æ€»å½’æ¡£', status: '', remark: '' },
                { name: 'æ—¥ç»“å·¥ä½œï¼šå½“æ—¥æŠ•è¯‰è§£å†³ç‡æœ€ç»ˆç¡®è®¤è¾¾æ ‡ï¼ˆâ‰¥95%ï¼‰', status: '', remark: '' },
                { name: 'æ˜æ—¥æœ€ç»ˆå‡†å¤‡ï¼šå¤œå®¡å•æ®ä¸æŠ¥è¡¨å·²æ•´ç†å®Œæ¯•ï¼Œå‡†å¤‡è¿‡å®¡', status: '', remark: '' },
                { name: 'æ˜æ—¥æœ€ç»ˆå‡†å¤‡ï¼šå†æ¬¡å¤æ ¸æ˜æ—¥é¢„æŠµå®¢äººå®‰æ’ï¼Œç¡®ä¿100%å‡†ç¡®', status: '', remark: '' },
                { name: 'æ˜æ—¥æœ€ç»ˆå‡†å¤‡ï¼šå®Œæˆæ˜æ—¥æ‰€æœ‰é¢„æŠµå®¢äººçš„æœ€ç»ˆæˆ¿å¡å‡†å¤‡', status: '', remark: '' },
                { name: 'æ˜æ—¥æœ€ç»ˆå‡†å¤‡ï¼šå°†æ˜æ—¥VIPåŠç‰¹æ®Šéœ€æ±‚çš„æœ€ç»ˆéƒ¨ç½²é€šçŸ¥åˆ°å²—', status: '', remark: '' },
                { name: 'äº¤æ¥æ±‡æŠ¥ï¼šéœ€è·Ÿè¿›çš„ç»´ä¿®ã€å®¢éœ€ç­‰å·²ä¹¦é¢äº¤æ¥è‡³ç›¸å…³éƒ¨é—¨', status: '', remark: '' },
                { name: 'äº¤æ¥æ±‡æŠ¥ï¼šå·²å‘å€¼ç­ç»ç†åšå½“æ—¥è¿è¥æ±‡æŠ¥ï¼ˆé‡ç‚¹å®¢æƒ…ã€æŠ•è¯‰ã€å·®è¯„ï¼‰', status: '', remark: '' },
                { name: 'äº¤æ¥æ±‡æŠ¥ï¼šäº¤æ¥ç­æœ¬è®°å½•å®Œæ•´ï¼Œå·²ä¸ä¸‹ä¸€ç­æ¬¡å……åˆ†æ²Ÿé€š', status: '', remark: '' },
                { name: 'å¡«å†™å§“å', status: '', remark: '' }
            ]
        },
        'E': { // å®¢æˆ¿éƒ¨ (New)
            'ä¸€ã€å‡†å¤‡é˜¶æ®µ (æ—©ç­/å¼€ç­)': [
                { name: 'æ˜¨æ—¥å¤ç›˜ï¼šæ˜¨æ—¥æœ€ç»ˆå…¥ä½æˆ¿é—´æ•°å·²ç»Ÿè®¡', status: '', remark: '' },
                { name: 'ä»Šæ—¥è¿è¥ï¼šå·²åè°ƒå®¢æˆ¿éƒ¨å¯¹é¢„ç¦»æˆ¿è¿›è¡Œé¢„æŸ¥æˆ¿å‡†å¤‡', status: '', remark: '' },
                { name: 'å†…éƒ¨å‡†å¤‡ï¼šç­å‰ä¼šå·²å¬å¼€ï¼Œå‘˜å·¥ä»ªå®¹ä»ªè¡¨åˆæ ¼', status: '', remark: '' },
                { name: 'å†…éƒ¨å‡†å¤‡ï¼šå·²ä¸å®¢æˆ¿éƒ¨æ ¸å¯¹ç¡®è®¤å½“å‰å¯å”®æˆ¿æ€', status: '', remark: '' },
                { name: 'æ˜æ—¥é¢„å¤‡ï¼šå·²è¯†åˆ«æ˜æ—¥æ½œåœ¨VIPåŠç‰¹æ®Šéœ€æ±‚å®¢äºº', status: '', remark: '' },
                { name: 'å¡«å†™å§“å', status: '', remark: '' }
            ]
        },
        'B': { // é¤é¥®éƒ¨
            'ä¸€ã€å‡†å¤‡é˜¶æ®µ (å¼€å¸‚å‰)': [
                { name: 'é¢„è®¢ä¸è®¡åˆ’ï¼šæ ¸æŸ¥æ‰€æœ‰é¢„è®¢ï¼ˆå®´ä¼šã€åŒ…å¢ã€æ•£å°ï¼‰', status: '', remark: '' },
                { name: 'é¢„è®¢ä¸è®¡åˆ’ï¼šç¡®è®¤VIP/ç‰¹æ®Šè¦æ±‚é¢„è®¢', status: '', remark: '' },
                { name: 'é¢„è®¢ä¸è®¡åˆ’ï¼šå°†å®´ä¼š/å›¢é˜Ÿä¿¡æ¯åŒæ­¥ç»™å‰å…', status: '', remark: '' },
                { name: 'é¢„è®¢ä¸è®¡åˆ’ï¼šæ ¹æ®é¢„è®¢å®¡æ ¸å¤‡è´§ä¸æ’ç­', status: '', remark: '' },
                { name: 'ç¯å¢ƒä¸è®¾æ–½ï¼šç¯å…‰ã€ç©ºè°ƒã€èƒŒæ™¯éŸ³ä¹æ­£å¸¸', status: '', remark: '' },
                { name: 'ç¯å¢ƒä¸è®¾æ–½ï¼šæ‰€æœ‰æœåŠ¡è®¾å¤‡è¿è¡Œæ­£å¸¸', status: '', remark: '' },
                { name: 'ç¯å¢ƒä¸è®¾æ–½ï¼šé¤æ¡Œæ‘†å°ç¬¦åˆæ ‡å‡†', status: '', remark: '' },
                { name: 'ç¯å¢ƒä¸è®¾æ–½ï¼šåŒºåŸŸå«ç”Ÿè¾¾æ ‡ï¼ˆå¤‡é¤åŒºã€å‡ºèœå£ã€æ´—æ‰‹é—´ï¼‰', status: '', remark: '' },
                { name: 'å¨æˆ¿å‡†å¤‡ï¼šå‘˜å·¥ä»ªå®¹ä»ªè¡¨åˆæ ¼ï¼Œç­å‰ä¼šå·²å¼€', status: '', remark: '' },
                { name: 'å¨æˆ¿å‡†å¤‡ï¼šå¨æˆ¿å«ç”Ÿæ¸…æ´æ¶ˆæ¯’å®Œæˆ', status: '', remark: '' },
                { name: 'å¨æˆ¿å‡†å¤‡ï¼šå†°ç®±æ¸©åº¦æ­£å¸¸å¹¶è®°å½•', status: '', remark: '' },
                { name: 'å¨æˆ¿å‡†å¤‡ï¼šå½“æ—¥æ²½æ¸…/æ¨èèœå“æ¸…å•å·²ç¡®è®¤', status: '', remark: '' },
                { name: 'åˆ°å²—äººå‘˜ç¡®è®¤', status: '', remark: '' }
            ],
            'äºŒã€æ‰§è¡Œé˜¶æ®µ (è¿è¥ä¸­)': [
                { name: 'æœåŠ¡è´¨é‡ï¼šå‘˜å·¥æŒ‰æ ‡å‡†æµç¨‹æœåŠ¡ï¼ˆè¿å®¾ã€ç‚¹å•ç­‰ï¼‰', status: '', remark: '' },
                { name: 'æœåŠ¡è´¨é‡ï¼šVIP/ç‰¹æ®Šå®¢äººæœåŠ¡å·²é‡ç‚¹å…³æ³¨', status: '', remark: '' },
                { name: 'æœåŠ¡è´¨é‡ï¼šå‡ºèœé€Ÿåº¦æ­£å¸¸ï¼Œæ— ä¸¥é‡ç§¯å‹', status: '', remark: '' },
                { name: 'æœåŠ¡è´¨é‡ï¼šå¯¹å‡ºå“èœå“è´¨é‡è¿›è¡ŒæŠ½æŸ¥', status: '', remark: '' },
                { name: 'å®‰å…¨ä¸å«ç”Ÿï¼šé¤æ¡Œç¿»å°ååŠæ—¶æ¸…ç†', status: '', remark: '' },
                { name: 'å®‰å…¨ä¸å«ç”Ÿï¼šé£Ÿå“ç•™æ ·æ“ä½œè§„èŒƒ', status: '', remark: '' },
                { name: 'å®‰å…¨ä¸å«ç”Ÿï¼šä¼ èœé€šé“ã€æ¶ˆé˜²é€šé“ç•…é€šæ— é˜»', status: '', remark: '' },
                { name: 'å®¢æƒ…å¤„ç†ï¼šç°åœºå·¡è§†ï¼ŒåŠæ—¶å“åº”å®¢äººéœ€æ±‚', status: '', remark: '' },
                { name: 'å®¢æƒ…å¤„ç†ï¼šæ”¶é›†å®¢äººåé¦ˆå¹¶é€šçŸ¥å¨æˆ¿', status: '', remark: '' },
                { name: 'å®¢æƒ…å¤„ç†ï¼šå¼•å¯¼æ»¡æ„å®¢äººç»™äºˆå¥½è¯„', status: '', remark: '' },
                { name: '07:00 æ—©é¤å·¡æŸ¥ï¼šæ£€æŸ¥å‡ºå“åŒºä¸é¤å°ï¼Œç¡®ä¿åŠæ—¶æ·»èœã€è¡¥å……é¤å…·ä¸ä¿æ¸©æªæ–½åˆ°ä½', status: '', remark: '' },
                { name: '07:30 æ—©é¤å·¡æŸ¥ï¼šæ£€æŸ¥å°±é¤é«˜å³°åŠ¨çº¿ä¸ç¿»å°æ•ˆç‡ï¼Œç¡®ä¿åŠæ—¶æ”¶é¤ã€åŠæ—¶è¡¥èœã€ç°åœºæ•´æ´', status: '', remark: '' },
                { name: '08:00 æ—©é¤å·¡æŸ¥ï¼šæ£€æŸ¥æ”¶å°¾èŠ‚å¥ä¸å‰©ä½™èœå“ç®¡ç†ï¼Œç¡®ä¿åŠæ—¶æ”¶é¤ã€è¡¥ç¼ºã€é¿å…æ–­æ¡£ä¸æµªè´¹', status: '', remark: '' },
                { name: 'æ£€æŸ¥é¡¹ï¼šå‰å°å‘˜å·¥ä»ªå®¹ä»ªè¡¨è§„èŒƒã€ç€è£…ç»Ÿä¸€ã€ç²¾ç¥é¥±æ»¡ã€æœåŠ¡äº²å’Œ', status: '', remark: '' },
                { name: 'æ£€æŸ¥é¡¹ï¼šå¤§å…å·¥ä½œäººå‘˜è§å®¢ä¸»åŠ¨é—®å€™ã€æœåŠ¡å¼•å¯¼æ¸…æ™°ã€å“åº”åŠæ—¶', status: '', remark: '' },
                { name: 'æ£€æŸ¥é¡¹ï¼šåå¨æ“ä½œè§„èŒƒã€å«ç”Ÿè¾¾æ ‡ï¼›é¤å…æœåŠ¡å‘˜æœåŠ¡ä¸»åŠ¨ã€æ”¶é€é¤é«˜æ•ˆ', status: '', remark: '' },
                { name: 'æ£€æŸ¥é¡¹ï¼šå°±é¤é—¨å£è®¾ä¸“èŒè¿å®¾ã€ä¸»åŠ¨è¿é€å®¢äººã€å¼•å¯¼å…¥åº§åˆ°ä½', status: '', remark: '' }
            ],
            'ä¸‰ã€æ”¶å°¾ä¸äº¤æ¥é˜¶æ®µ (æ”¶å¸‚å)': [
                { name: 'æ”¶å¸‚å·¥ä½œï¼šå¯å›æ”¶é¤å…·ã€å¸ƒè‰å·²å½’ä½', status: '', remark: '' },
                { name: 'æ”¶å¸‚å·¥ä½œï¼šé¤å…/å¨æˆ¿å…¨é¢æ¸…æ´æ•´ç†å®Œæˆ', status: '', remark: '' },
                { name: 'æ”¶å¸‚å·¥ä½œï¼šéå¿…è¦è®¾å¤‡å·²å…³é—­ï¼ˆèŠ‚èƒ½ï¼‰', status: '', remark: '' },
                { name: 'æ”¶å¸‚å·¥ä½œï¼šé‡ç‚¹é£Ÿæ/é…’æ°´å·²ç›˜ç‚¹', status: '', remark: '' },
                { name: 'ä¿¡æ¯æ±‡æ€»ï¼šè®°å½•ç”¨é¤äººæ•°ã€ç¿»å°ç‡ç­‰æ•°æ®', status: '', remark: '' },
                { name: 'ä¿¡æ¯æ±‡æ€»ï¼šæ›´æ–°å¹¶åŒæ­¥æ¬¡æ—¥é¢„è®¢å˜æ›´', status: '', remark: '' },
                { name: 'ä¿¡æ¯æ±‡æ€»ï¼šè®¾å¤‡æ•…éšœ/æœåŠ¡é—®é¢˜å·²è®°å½•äº¤æ¥', status: '', remark: '' },
                { name: 'å¤œé—´è”åŠ¨ï¼šå¤œé—´é€é¤æµç¨‹å·²ç¡®è®¤ï¼Œé€šè®¯ç•…é€š', status: '', remark: '' },
                { name: 'å¤œé—´è”åŠ¨ï¼šå·²ä¸å‰å…æ ¸å¯¹æ¬¡æ—¥æ—©é¤é¢„ä¼°äººæ•°', status: '', remark: '' },
                { name: 'å¡«å†™å§“å', status: '', remark: '' }
            ]
        },
        'C': { // å€¼ç­ç»ç†
            'ä¸€ã€æ—©é—´å‡†å¤‡æ ¸æŸ¥ (08:30-11:00)': [
                { name: 'å¤æ ¸é¤é¥®éƒ¨ ã€Šå‡†å¤‡è¡¨ã€‹ï¼Œç°åœºæ£€æŸ¥1ä¸ªå®´ä¼šå…/VIPåŒ…å¢å‡†å¤‡æƒ…å†µ', status: '', remark: '' },
                { name: 'æ ¸å®åˆ°å²—äººæ•° å¹¶ä¸‹æ–¹å¤‡æ³¨', status: '', remark: '' },
                { name: '07:15 æ—©é¤å·¡æŸ¥ï¼šæ£€æŸ¥å‡ºå“åŒºä¸é¤å°ï¼Œç¡®ä¿åŠæ—¶æ·»èœã€è¡¥å……é¤å…·ä¸ä¿æ¸©æªæ–½åˆ°ä½', status: '', remark: '' },
                { name: '07:45 æ—©é¤å·¡æŸ¥ï¼šæ£€æŸ¥å°±é¤é«˜å³°åŠ¨çº¿ä¸ç¿»å°æ•ˆç‡ï¼Œç¡®ä¿åŠæ—¶æ”¶é¤ã€åŠæ—¶è¡¥èœã€ç°åœºæ•´æ´', status: '', remark: '' },
                { name: '08:15 æ—©é¤å·¡æŸ¥ï¼šæ£€æŸ¥æ”¶å°¾èŠ‚å¥ä¸å‰©ä½™èœå“ç®¡ç†ï¼Œç¡®ä¿åŠæ—¶æ”¶é¤ã€è¡¥ç¼ºã€é¿å…æ–­æ¡£ä¸æµªè´¹', status: '', remark: '' },
                { name: 'ä»Šæ—¥è¿è¥ï¼šé€å›¢', status: '', remark: '' },
                { name: 'å¤æ ¸å‰å…ä»¥åŠå®¢æˆ¿éƒ¨ã€Šå‡†å¤‡è¡¨ã€‹ï¼Œç°åœºæŠ½æŸ¥1-2é—´VIPæˆ¿æ¬¢è¿ç¤¼é‡åŠå¸ƒç½®', status: '', remark: '' },
                { name: 'æŠ½æŸ¥å¨æˆ¿ï¼ˆ1F/3Fï¼‰å«ç”Ÿã€é£Ÿæå‚¨å­˜åŠæ™¨ä¼šè®°å½•', status: '', remark: '' },
                { name: 'ç¡®è®¤A/Béƒ¨é—¨é—´VIPã€å®´ä¼šä¿¡æ¯å·²åŒå‘åŒæ­¥', status: '', remark: '' }
            ],
            'äºŒã€åˆé—´é«˜å³°å·¡æ£€ (11:30-14:00)': [
                { name: 'å‰å°é«˜å³°æš—è®¿ï¼Œè§‚å¯ŸæœåŠ¡æµç¨‹ã€æ•ˆç‡ä¸SOPç¬¦åˆåº¦', status: '', remark: '' },
                { name: 'é¤å…ï¼ˆå¦‚é¢å’Œè½©ï¼‰åˆé¤ä½“éªŒï¼Œè®°å½•è¿å®¾ã€ä¸Šèœã€å·¡å°ç­‰æœåŠ¡æ—¶æ•ˆ', status: '', remark: '' },
                { name: 'æŠ½æŸ¥å¨æˆ¿å‡ºèœå£ç§©åºåŠä¸€é“å‡ºèœå“ç›¸', status: '', remark: '' },
                { name: 'å·¡æŸ¥å…¨åº—åŠ¨çº¿ï¼ˆä¼ èœé€šé“ã€ç”µæ¢¯ã€æ¶ˆé˜²é€šé“ï¼‰ç•…é€šä¸æ¸…æ´', status: '', remark: '' }
            ],
            'ä¸‰ã€ä¸‹åˆç»¼åˆå¤„ç† (14:00-17:00)': [
                { name: 'å…œåº•å¤„ç†æ‰€æœ‰ä¸ŠæŠ¥çš„é‡å¤§å®¢è¯‰ï¼Œç¡®ä¿è§£å†³ç‡', status: '', remark: '' },
                { name: 'å…œåº•è·Ÿè¿›ä¸ŠæŠ¥çš„å·¥ç¨‹ç»´ä¿®å•ï¼Œç°åœºéªŒè¯å½±å“å®¢äººçš„é—®é¢˜å·²è§£å†³', status: '', remark: '' },
                { name: 'å…œåº•å¤„ç†æ‰€æœ‰ç½‘ç»œå·®è¯„ï¼ˆ<4.8åˆ†ï¼‰ï¼Œåˆ¶å®šå¹¶è·Ÿè¸ªè¡¥æ•‘æ–¹æ¡ˆ', status: '', remark: '' },
                { name: 'å®¡æ ¸æ¬¡æ—¥ã€Šé‡å¤§æ¥å¾…é€šçŸ¥å•ã€‹åŠå‡†å¤‡æƒ…å†µï¼Œå¿…è¦æ—¶å¬å¼€åè°ƒä¼š', status: '', remark: '' }
            ],
            'å››ã€æ™šé—´æ”¶å°¾æ ¸æŸ¥ (20:00-äº¤ç­å‰)': [
                { name: 'å¤æ ¸Aéƒ¨ã€Šæ”¶å°¾è¡¨ã€‹ï¼Œæœ€ç»ˆç¡®è®¤æ¬¡æ—¥é¢„æŠµå®‰æ’100%å‡†ç¡®', status: '', remark: '' },
                { name: 'å¤æ ¸Béƒ¨ã€Šæ”¶å°¾è¡¨ã€‹ï¼Œç¡®è®¤å¨æˆ¿å®‰å…¨æ”¶å¸‚ï¼Œå¤œé—´æœåŠ¡å°±ç»ª', status: '', remark: '' },
                { name: 'è¿›è¡Œå…¨åº—å¤œé—´å®‰å…¨æœ€ç»ˆå·¡æŸ¥ï¼ˆå«åå°åŒºåŸŸï¼‰', status: '', remark: '' },
                { name: 'å®Œæˆã€Šå€¼ç­ç»ç†æ¯æ—¥è¿è¥æŠ¥å‘Šã€‹ï¼Œä¸ä¸‹ä¸€ç­è¯¦ç»†äº¤æ¥', status: '', remark: '' },
                { name: 'å¡«å†™å§“å', status: '', remark: '' }
            ]
        },
        // D çš„é€»è¾‘å°†åœ¨ä»£ç ä¸­åŠ¨æ€ç”Ÿæˆï¼Œè¿™é‡Œå ä½
        'D': {}
    };

    createApp({
        setup() {
            const currentRole = ref(null);
            const currentDate = ref(new Date().toLocaleDateString('zh-CN'));
            const currentTasks = ref({});

            const selectRole = (role) => {
                currentRole.value = role;

                if (role === 'D') {
                    // --- Dè§’è‰²ï¼šåŠ¨æ€ç”Ÿæˆé€»è¾‘ ---
                    const monthIdx = new Date().getMonth();
                    const monthName = MONTH_NAMES[monthIdx];

                    currentTasks.value = {
                        "â˜€ï¸ æ™¨é—´æ ¸å¿ƒæŒæ§ (08:30-12:00)": [
                            { name: "ç»è¥æ•°æ®æ™¨ä¼š", desc: "å®¡é˜…æ˜¨æ—¥è¥æ”¶/RevPAR/èƒ½è€—/GOPï¼Œåˆ†æåå·®", status: "", remark: "" },
                            { name: "è¿è¥å…¨åŸŸå·¡æŸ¥", desc: "å‰å°/é¤å…/å¨æˆ¿/å®¢æˆ¿SOPæ‰§è¡ŒåŠè®¡åˆ’å«ç”Ÿæ£€æŸ¥", status: "", remark: "" },
                            { name: "è®¢å•ä¸æ¥å¾…é¢„æ§", desc: "æŒæ¡æœªæ¥7-14å¤©è¶‹åŠ¿ï¼Œè°ƒæ•´æˆ¿ä»·ï¼Œå®¡æ‰¹VIPæ–¹æ¡ˆ", status: "", remark: "" }
                        ],
                        "ğŸŒ¤ï¸ åˆåè¿è¥ç»´ç³» (13:00-17:00)": [
                            { name: "é‡è¦å®¢æˆ·æ‹œè®¿", desc: "æ¯æ—¥æ‹œè®¿æˆ–è‡´ç”µ1-2ä½åœ¨åº—VIPï¼Œæ”¶é›†åé¦ˆ", status: "", remark: "" },
                            { name: "æŠ•è¯‰ä¸è´¨é‡ç»ˆå®¡", desc: "æ‰¹é˜…å€¼ç­ç»ç†æŠ¥å‘Šï¼Œäº²è‡ªç£åŠé‡å¤§/å‡çº§æŠ•è¯‰", status: "", remark: "" },
                            { name: "é«˜å³°æœŸç°åœºç£å¯¼", desc: "å…¥ä½/é€€æˆ¿/ç”¨é¤é«˜å³°æ—¶æ®µç°åœºå€¼å®ˆ", status: "", remark: "" },
                            { name: "ç»ˆæå†³ç­–å¤„ç†", desc: "å¤„ç†æ¶‰åŠæˆ˜ç•¥é£é™©æˆ–é‡å¤§èµ„æºè°ƒé…é—®é¢˜", status: "", remark: "" }
                        ],
                        [`ğŸ“… ${monthName}æˆ˜ç•¥ä¸“é¡¹ (åŠ¨æ€)`]: MONTHLY_MISSIONS[monthIdx].map(item => ({
                            name: item.name,
                            desc: item.desc,
                            status: "",
                            remark: ""
                        }))
                    };
                } else {
                    // --- A/B/C/Eè§’è‰²ï¼šåŠ è½½å›ºå®šæ¨¡æ¿ ---
                    currentTasks.value = JSON.parse(JSON.stringify(TASK_DATA_TEMPLATE[role]));
                }
            };

            const currentConfig = computed(() => {
                return currentRole.value ? ROLE_CONFIGS[currentRole.value] : {};
            });

            // è®¡ç®—å®Œæˆç‡
            const completionRate = computed(() => {
                let total = 0;
                let completed = 0;
                Object.values(currentTasks.value).forEach(phase => {
                    phase.forEach(task => {
                        total++;
                        if (task.status === 'T') completed++;
                    });
                });
                return total === 0 ? 0 : Math.round((completed / total) * 100);
            });

            const exportToExcel = () => {
                const config = currentConfig.value;
                const rows = [];

                // 1. æ„å»ºå¤´éƒ¨ä¿¡æ¯
                rows.push(["é…’åº—æ¯æ—¥è¿è¥æ±‡æŠ¥å•", "", "", "", ""]);
                rows.push(["è§’è‰²:", config.title, "æ—¥æœŸ:", currentDate.value, ""]);
                rows.push(["ç»¼åˆå®Œæˆç‡:", completionRate.value + "%", "", "", ""]);
                rows.push([""]); // ç©ºè¡Œ

                // 2. è¡¨å¤´
                rows.push(["é˜¶æ®µ/ç±»åˆ«", "åºå·", "æ£€æŸ¥é¡¹ç›®", "è¯¦ç»†è¯´æ˜(DOnly)", "çŠ¶æ€ (T/F)", "å¤‡æ³¨/å¼‚å¸¸è¯´æ˜"]);

                // 3. å¡«å……æ•°æ®
                Object.entries(currentTasks.value).forEach(([phase, tasks]) => {
                    tasks.forEach((task, index) => {
                        rows.push([
                            phase,
                            index + 1,
                            task.name,
                            task.desc || "-", // Dè§’è‰²æœ‰descï¼ŒABCæ— 
                            task.status === 'T' ? 'å®Œæˆ' : (task.status === 'F' ? 'æœªå®Œæˆ' : ''),
                            task.remark
                        ]);
                    });
                });

                // 4. ç”Ÿæˆæ–‡ä»¶
                const wb = XLSX.utils.book_new();
                const ws = XLSX.utils.aoa_to_sheet(rows);

                // è®¾ç½®åˆ—å®½
                ws['!cols'] = [{wch:25}, {wch:8}, {wch:40}, {wch:30}, {wch:12}, {wch:40}];

                XLSX.utils.book_append_sheet(wb, ws, "æ—¥æŠ¥è¯¦æƒ…");
                XLSX.writeFile(wb, `${currentDate.value}_${currentRole.value}_è¿è¥æ—¥æŠ¥.xlsx`);
            };

            return {
                currentRole,
                currentDate,
                currentTasks,
                currentConfig,
                completionRate,
                selectRole,
                exportToExcel
            };
        }
    }).mount('#app');
</script>

</body>
</html>


